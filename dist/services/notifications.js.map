{"version":3,"file":"notifications.js","sources":["../../src/services/notifications.js"],"sourcesContent":["/* eslint-disable ember/no-classic-classes, ember/no-get, ember/no-runloop, prettier/prettier */\nimport Service from '@ember/service';\nimport { A } from '@ember/array';\nimport EmberObject, { set } from '@ember/object';\nimport { later, cancel } from '@ember/runloop';\nimport { getOwner } from '@ember/application';\n\nexport default class NotificationsService extends Service {\n  content = A();\n\n  constructor(...args) {\n    super(...args);\n\n    const config = getOwner(this).resolveRegistration('config:environment');\n\n    this.globals = config['ember-cli-notifications'] || {}; // Import app config object\n  }\n\n  // Method for adding a notification\n  addNotification(options) {\n    // If no message is set, throw an error\n    if (!options.message) {\n      throw new Error('No notification message set');\n    }\n\n    const notification = EmberObject.create({\n      message: options.message,\n      type: options.type || 'info',\n      autoClear: options.autoClear ?? this.globals.autoClear ?? false,\n      clearDuration:\n        options.clearDuration ?? this.globals.clearDuration ?? 3200,\n      onClick: options.onClick,\n      htmlContent: options.htmlContent || false,\n      cssClasses: options.cssClasses,\n    });\n\n    this.content.pushObject(notification);\n\n    if (notification.autoClear) {\n      set(notification, 'remaining', notification.clearDuration);\n\n      this.setupAutoClear(notification);\n    }\n\n    return notification;\n  }\n\n  // Helper methods for each type of notification\n  error(message, options) {\n    return this.addNotification({\n      ...options,\n      message,\n      type: 'error',\n    });\n  }\n\n  success(message, options) {\n    return this.addNotification({\n      ...options,\n      message,\n      type: 'success',\n    });\n  }\n\n  info(message, options) {\n    return this.addNotification({\n      ...options,\n      message,\n      type: 'info',\n    });\n  }\n\n  warning(message, options) {\n    return this.addNotification({\n      ...options,\n      message,\n      type: 'warning',\n    });\n  }\n\n  removeNotification(notification) {\n    if (!notification) {\n      return;\n    }\n\n    notification.set('dismiss', true);\n\n    // Delay removal from DOM for dismissal animation\n    later(\n      this,\n      () => {\n        this.content.removeObject(notification);\n      },\n      500\n    );\n  }\n\n  setupAutoClear(notification) {\n    notification.set('startTime', Date.now());\n\n    const timer = later(\n      this,\n      () => {\n        // Hasn't been closed manually\n        if (this.content.indexOf(notification) >= 0) {\n          this.removeNotification(notification);\n        }\n      },\n      notification.remaining\n    );\n\n    set(notification, 'timer', timer);\n  }\n\n  pauseAutoClear(notification) {\n    cancel(notification.timer);\n\n    const elapsed = Date.now() - notification.startTime;\n    const remaining = notification.clearDuration - elapsed;\n\n    set(notification, 'remaining', remaining);\n  }\n\n  clearAll() {\n    this.content.forEach((notification) => {\n      this.removeNotification(notification);\n    });\n\n    return this;\n  }\n\n  setDefaultAutoClear(autoClear) {\n    this.globals.autoClear = autoClear;\n  }\n\n  setDefaultClearDuration(clearDuration) {\n    this.globals.clearDuration = clearDuration;\n  }\n}\n"],"names":["NotificationsService","Service","content","A","constructor","args","config","getOwner","resolveRegistration","globals","addNotification","options","message","Error","notification","EmberObject","create","type","autoClear","clearDuration","onClick","htmlContent","cssClasses","pushObject","set","setupAutoClear","error","success","info","warning","removeNotification","later","removeObject","Date","now","timer","indexOf","remaining","pauseAutoClear","cancel","elapsed","startTime","clearAll","forEach","setDefaultAutoClear","setDefaultClearDuration"],"mappings":"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"}